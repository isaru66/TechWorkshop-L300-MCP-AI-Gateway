---
title: '1. Deploy Azure resources with azd'
layout: default
nav_order: 1
parent: 'Exercise 01: Deploy and configure resources'
---

# Task 01 - Deploy Azure resources with azd

## Introduction

Before you can start building your MCP servers and AI Gateway, you need to deploy the necessary Azure resources. This includes setting up a resource group, deploying Azure infrastructure using Azure Developer CLI (azd), and provisioning all required services for your MCP and AI Gateway solution.

## Description

In this task, you will use the Azure Developer CLI (azd) to provision all necessary Azure resources for your MCP and AI Gateway solution. The `azd up` command will handle creating the resource group, deploying the Bicep infrastructure, and setting up all required services in a single operation. In addition, you will install any software prerequisites needed for the application to run.

## Success Criteria

- You have installed software necessary for the application to run.
- You have successfully provisioned Azure resources using `azd up`.
- You have verified that all Azure resources are deployed correctly.

## Learning Resources

- Cloning a repository via the [command line](https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/cloning-a-repository) or [GitHub Desktop](https://docs.github.com/en/desktop/contributing-and-collaborating-using-github-desktop/cloning-a-repository-from-github-to-github-desktop)
- [Azure Developer CLI (azd)](https://learn.microsoft.com/azure/developer/azure-developer-cli/overview?tabs=linux)
- [Get started using Azure Developer CLI (azd)](https://learn.microsoft.com/azure/developer/azure-developer-cli/get-started?tabs=windows)
- [Create Bicep files by using Visual Studio Code](https://learn.microsoft.com/azure/azure-resource-manager/bicep/visual-studio-code?tabs=CLI)

## Key Tasks

### 01: Fork the repository

Fork [this GitHub repository](https://github.com/isaru66/TechWorkshop-L300-MCP-AI-Gateway) to your account. You will need to fork the repo in order to modify and use GitHub Actions workflows in later tasks.

<details markdown="block">
<summary><strong>Expand this section to view the solution</strong></summary>

In order to fork this repository, make sure that you are signed in to GitHub with the account you would like to use. Then, select the **Fork** button.

![Fork the GitHub repository](../../media/Solution/0101_Fork1.png)

On the next page, select your account as the Owner and leave the repository name alone. Then, select **Create fork** to complete the process.

![Complete the process of forking the GitHub repository](../../media/Solution/0101_Fork2.png)

</details>

### 02: Run Codespace or install necessary software

To work through this training, you can either use a GitHub Codespace or install the necessary software on your local machine.

To use a GitHub Codespace, navigate to your forked repository and select the **Code** button. Then, select the **Codespaces** tab and choose **Create codespace on main**.

![Create a GitHub Codespace](../../media/Solution/0101_Codespaces1.png)

This Codespace is pre-configured with all the necessary software to complete this training.

Alternatively, you can install the necessary software on your local machine. This includes:

- [Azure CLI](https://learn.microsoft.com/cli/azure/install-azure-cli)
- [Azure Developer CLI (azd)](https://learn.microsoft.com/azure/developer/azure-developer-cli/install-azd)
- [A Git client](https://git-scm.com/download/). An alternative option is to install [GitHub Desktop](https://desktop.github.com/).
- [Python 3.10 or later](https://www.python.org/downloads/)
- [Visual Studio Code](https://code.visualstudio.com/download)
- [The Bicep tools Visual Studio Code extension](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-bicep)
- [Docker Desktop](https://www.docker.com/products/docker-desktop/) (optional, but recommended)

If you do not use a Codespace, you will also need to clone the repository to your local machine.

You can do this using the following command:

```bash
git clone https://github.com/<your-username>/TechWorkshop-L300-MCP-AI-Gateway.git
```

Make sure to replace `<your-username>` with your actual GitHub username.

### 03: Provision Azure resources using azd up

After you have set up your development environment, the next step is to provision all necessary Azure resources using the Azure Developer CLI (azd). The `azd up` command will create a resource group, deploy the Bicep infrastructure, and provision all required Azure services in a single operation.

<details markdown="block">
<summary><strong>Expand this section to view the solution</strong></summary>

First, ensure that you are logged into both the Azure CLI and the Azure Developer CLI. You can do so using the following commands:

```bash
# Login to Azure CLI
az login

# Login to Azure Developer CLI
azd auth login
```

{: .note }
> If you are using a GitHub Codespace, use `az login --use-device-code` to authenticate with Azure CLI.

{: .note }
> If you receive an error message reading, "Your sign-in was successful but does not meet the criteria to access this resource," you are likely using a Microsoft EMU account or some other account that has stringent restrictions on machine access. You will need to use an external MCAPS subscription or some other paid subscription to continue. A Visual Studio subscription will **not** be sufficient, as these accounts will likely not have access to Microsoft Foundry and the language models we will use.

Once authenticated, navigate to the root directory of the repository in your terminal and run the `azd up` command to provision the Azure resources:

```bash
azd up
```

The `azd up` command will prompt you for the following information:

1. **Environment name**: Enter a name for your environment (e.g., `kbtg-group08`). This will be used to generate unique resource names.
2. **Subscription**: Select the Azure subscription where you want to deploy the resources.
3. **Location**: Select the region where you want to deploy the resources. Use **swedencentral** as it contains more AI models than other regions.

{: .note }
> If you receive an error message indicating that you do not have sufficient VM quota in the given region, try a different region from the four listed above: `eastus2`, `swedencentral`, `francecentral`, `switzerlandwest`. If your account does not have sufficient quota in any of those four regions, you may create resources in another region but you will not be able to run the Red Teaming agent in Exercise 06.

After you provide this information, `azd` will begin provisioning your Azure resources. This process may take 10-15 minutes to complete. You can monitor the progress in the terminal.

Once the deployment is complete, `azd` will display a summary of the deployed resources and their endpoints. You can also view the deployment in the [Azure portal](https://portal.azure.com/) by navigating to the resource group that was created.

</details>
